import VulnerabilityMainContextDataScore from "@/components/contextData/vulnerability/VulnerabilityMainContextDataScore.vue"
import ContextDataScore from "@/components/contextData/shared/ContextDataScore.vue"
import CircularProgress from "@/components/progress/CircularProgress.vue"

describe("VulnerabilityMainContextDataScore.vue", () => {
  it("renders with correct score, percentage and name", () => {
    cy.mount(VulnerabilityMainContextDataScore, {
      props: {
        score: 6,
        percentage: 66.67,
        name: "Chaleur"
      },
      global: {
        components: {
          ContextDataScore,
          CircularProgress
        }
      }
    })

    cy.get('[data-cy="context-data-score"]').should("exist")
    cy.contains("vulnérabilité").should("exist")
  })

  it("handles different hazard names", () => {
    const hazardNames = ["Chaleur", "Sécheresse", "Submersion"]

    hazardNames.forEach((name) => {
      cy.mount(VulnerabilityMainContextDataScore, {
        props: {
          score: 5,
          percentage: 55.56,
          name
        },
        global: {
          components: {
            ContextDataScore,
            CircularProgress
          }
        }
      })

      cy.get('[data-cy="context-data-score"]').should("exist")
    })
  })

  it("displays vulnerability label", () => {
    cy.mount(VulnerabilityMainContextDataScore, {
      props: {
        score: 7,
        percentage: 77.78,
        name: "Canicule"
      },
      global: {
        components: {
          ContextDataScore,
          CircularProgress
        }
      }
    })

    cy.contains("vulnérabilité").should("exist")
  })

  it("handles minimum score", () => {
    cy.mount(VulnerabilityMainContextDataScore, {
      props: {
        score: 0,
        percentage: 0,
        name: "Chaleur"
      },
      global: {
        components: {
          ContextDataScore,
          CircularProgress
        }
      }
    })

    cy.get('[data-cy="context-data-score"]').should("exist")
  })

  it("handles maximum score", () => {
    cy.mount(VulnerabilityMainContextDataScore, {
      props: {
        score: 9,
        percentage: 100,
        name: "Chaleur"
      },
      global: {
        components: {
          ContextDataScore,
          CircularProgress
        }
      }
    })

    cy.get('[data-cy="context-data-score"]').should("exist")
  })

  it("handles mid-range scores", () => {
    cy.mount(VulnerabilityMainContextDataScore, {
      props: {
        score: 4,
        percentage: 44.44,
        name: "Chaleur"
      },
      global: {
        components: {
          ContextDataScore,
          CircularProgress
        }
      }
    })

    cy.get('[data-cy="context-data-score"]').should("exist")
  })
})
