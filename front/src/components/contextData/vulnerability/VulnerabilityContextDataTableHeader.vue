<script lang="ts" setup>
import { ref } from "vue"
import type { VulnerabilityFactor } from "@/types/vulnerability"
import VulnerabilityContexDataTableRow from "@/components/contextData/vulnerability/VulnerabilityContexDataTableRow.vue"

defineProps<{
  factorsWithScores: VulnerabilityFactor[]
  getScoreColor: (score: number, factorId: string) => string
  getScoreLabel: (score: number, factorId: string) => string
  getFactorDescription: (factorId: string) => string
}>()

const isTableCollapsed = ref(false)
const expandedFactor = ref<string | null>(null)

const toggleFactorInfo = (factorId: string) => {
  expandedFactor.value = expandedFactor.value === factorId ? null : factorId
}
</script>
<template>
  <div class="bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden">
    <div v-show="!isTableCollapsed" class="divide-y divide-gray-100">
      <vulnerability-contex-data-table-row
        v-for="(factor, index) in factorsWithScores"
        :key="factor.id"
        :factor="factor"
        :get-factor-description="getFactorDescription"
        :get-score-color="getScoreColor"
        :get-score-label="getScoreLabel"
        :index="index"
        @toggle-info="toggleFactorInfo"
      />
    </div>
  </div>
</template>
