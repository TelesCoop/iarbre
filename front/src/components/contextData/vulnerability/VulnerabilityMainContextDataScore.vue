<script lang="ts" setup>
import { computed } from "vue"

interface VulnerabilityMainScoreProps {
  score: number
  percentage: number
}

const props = defineProps<VulnerabilityMainScoreProps>()

const textColor = computed(() => {
  if (!props.percentage) return "text-gray-300"
  return props.percentage >= 80
    ? "text-red-500"
    : props.percentage >= 60
      ? "text-orange-500"
      : props.percentage >= 40
        ? "text-yellow-500"
        : "text-green-500"
})
</script>

<template>
  <section class="text-center" aria-labelledby="score-section">
    <h3 id="score-section" class="sr-only">Score de vulnérabilité</h3>

    <div class="relative inline-block">
      <circular-progress
        :percentage="percentage"
        :background-color="textColor"
        :aria-label="`Score de vulnérabilité: ${score} sur 9`"
        data-cy="circular-progress"
      />

      <div class="absolute inset-0 flex flex-col items-center justify-center">
        <span class="text-sm text-gray-600">Score :</span>
        <span
          class="text-xl md:text-3xl font-bold"
          :class="textColor"
          data-cy="vulnerability-score"
        >
          {{ score }}/9
        </span>
      </div>
    </div>
  </section>
</template>

<style scoped>
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}
</style>
